---
title: 'Neuroecon 2018 poster figures'
output:
github_document:
toc: yes
toc_float: yes
---

```{r}
p1 = boot_df %>%
  group_by(dv) %>%
  summarise(mean_icc = mean(icc),
            rt_acc = unique(rt_acc),
            overall_difference = unique(overall_difference),
            raw_fit = unique(raw_fit)) %>%
  mutate(rt_acc = as.character(rt_acc)) %>%
  ggplot(aes(factor(raw_fit, levels = c("raw", "EZ", "hddm"), labels=c("Raw", "EZ-diffusion", "Hierarchical diffusion")), mean_icc, fill=factor(rt_acc, levels = c("rt","accuracy", "drift rate", "threshold", "non-decision"), labels=c("Response Time", "Accuracy","Drift Rate", "Threshold", "Non-decision"))))+
  geom_boxplot()+
  facet_wrap(~factor(overall_difference, levels = c("non-contrast", "contrast", "condition"), labels = c("Non-contrast", "Contrast", "Condition")))+
  ylab("ICC")+
  xlab("")+
  theme(legend.title = element_blank(),
        legend.position = 'bottom',
        axis.text = element_text(size=36),
        axis.title.y = element_text(size=36), 
        strip.text = element_text(size=36),
        legend.text = element_text(size=36),
        legend.spacing.x = unit(0.4, "cm"),
        legend.key.size = unit(2, "cm"))+
  scale_y_continuous(breaks = seq(-1,1,0.5),
                     limits = c(-0.5,1))

ggsave('Boot_ddm_plot.jpeg', device = "jpeg", plot=p1, path = "../output/figures/", width = 38, height = 8, units = "in", limitsize = FALSE, dpi = 300)

```


```{r}
tmp = rel_df_sample_size %>% 
  group_by(sample_size) %>%
  summarise(mean_icc = mean(icc,na.rm=T),
            sem_icc = sem(icc), 
            mean_var_subs_pct = mean(var_subs_pct,na.rm=T),
            sem_var_subs_pct = sem(var_subs_pct),
            mean_var_ind_pct = mean(var_ind_pct, na.rm=T),
            sem_var_ind_pct = sem(var_ind_pct),
            mean_var_resid_pct = mean(var_resid_pct,na.rm=T),
            sem_var_resid_pct = sem(var_resid_pct))

rel_df_sample_size_summary %>%
  na.omit() %>%
  ggplot(aes(factor(sample_size), mean_icc))+
  geom_line(aes(group = dv), alpha = 0.1)+
  geom_line(data = tmp,aes(factor(sample_size),mean_icc, group=1), color="magenta", size=2)+
  geom_point(data = tmp,aes(factor(sample_size),mean_icc), color="magenta", size=4)+
  geom_errorbar(data = tmp,aes(ymin=mean_icc-sem_icc, ymax = mean_icc+sem_icc), color="magenta", width = 0.1, size=2)+
  ylab("Mean reliability 100 \n  samples of size n")+
  xlab("Sample size")+
  ylim(-1,1)+
  theme(axis.text = element_text(size=36),
        axis.title= element_text(size=32))

ggsave('Sample_size.jpeg', device = "jpeg", path = "../output/figures/", width = 14, height = 5, units = "in", limitsize = FALSE, dpi = 300)
```

```{r}
tmp = rel_df_sample_size %>% 
  group_by(sample_size, ddm_raw, overall_difference) %>%
  summarise(mean_icc = mean(icc, na.rm=T),
            sem_icc = sem(icc), 
            mean_var_subs_pct = mean(var_subs_pct, na.rm=T),
            sem_var_subs_pct = sem(var_subs_pct),
            mean_var_ind_pct = mean(var_ind_pct, na.rm=T),
            sem_var_ind_pct = sem(var_ind_pct),
            mean_var_resid_pct = mean(var_resid_pct, na.rm=T),
            sem_var_resid_pct = sem(var_resid_pct)) %>%
  na.exclude()

rel_df_sample_size_summary %>%
  filter(!is.na(overall_difference)) %>%
  ggplot(aes(factor(sample_size), mean_icc))+
  geom_line(aes(group = dv, color=ddm_raw), alpha = 0.1)+
  geom_line(data = tmp, aes(factor(sample_size),mean_icc, color=ddm_raw, group=ddm_raw), size=2)+
  geom_point(data = tmp, aes(factor(sample_size),mean_icc, color=ddm_raw), size=4)+
  geom_errorbar(data = tmp,aes(ymin=mean_icc-sem_icc, ymax = mean_icc+sem_icc, color=ddm_raw), width = 0.1)+
  facet_wrap(~overall_difference)+
  ylab("Mean reliability 100 \n samples of size n")+
  xlab("Sample size")+
  theme(legend.title = element_blank(),
        legend.position = "bottom",
        strip.text = element_text(size=36),
        legend.text = element_text(size=36),
        legend.spacing.x = unit(0.4, "cm"),
        legend.key.size = unit(4, "cm"))+
  ylim(-1,1)+
  theme(axis.text = element_text(size=36),
        axis.title= element_text(size=36))

ggsave('Sample_size_by_type.jpeg', device = "jpeg", path = "../output/figures/", width = 38, height = 8, units = "in", limitsize = FALSE, dpi = 300)
```