---
title: 'Neuroecon 2018 poster figures'
output:
github_document:
toc: yes
toc_float: yes
---

```{r}
p1 = boot_df %>%
  group_by(dv) %>%
  summarise(mean_icc = mean(icc),
            rt_acc = unique(rt_acc),
            overall_difference = unique(overall_difference),
            raw_fit = unique(raw_fit)) %>%
  mutate(rt_acc = as.character(rt_acc)) %>%
  ggplot(aes(factor(raw_fit, levels = c("raw", "EZ", "hddm"), labels=c("Raw", "EZ-diffusion", "Hierarchical diffusion")), mean_icc, fill=factor(rt_acc, levels = c("rt","accuracy", "drift rate", "threshold", "non-decision"), labels=c("Response Time", "Accuracy","Drift Rate", "Threshold", "Non-decision"))))+
  geom_boxplot()+
  facet_wrap(~factor(overall_difference, levels = c("non-contrast", "contrast", "condition"), labels = c("Non-contrast", "Contrast", "Condition")))+
  ylab("ICC")+
  xlab("")+
  theme(legend.title = element_blank(),
        legend.position = 'bottom',
        axis.text = element_text(size=36),
        axis.title.y = element_text(size=36), 
        strip.text = element_text(size=36),
        legend.text = element_text(size=36),
        legend.spacing.x = unit(0.4, "cm"),
        legend.key.size = unit(2, "cm"))+
  scale_y_continuous(breaks = seq(-1,1,0.5),
                     limits = c(-0.5,1))

ggsave('Boot_ddm_plot.jpeg', device = "jpeg", plot=p1, path = "../output/figures/", width = 38, height = 8, units = "in", limitsize = FALSE, dpi = 300)

```


```{r}
p2 = rel_df %>%
  group_by(rt_acc, overall_difference, raw_fit) %>%
  summarise(mean_var_subs_pct = mean(var_subs_pct),
            mean_var_ind_pct = mean(var_ind_pct),
            mean_var_resid_pct = mean(var_resid_pct),
            sem_var_subs_pct = sem(var_subs_pct),
            sem_var_ind_pct = sem(var_ind_pct),
            sem_var_resid_pct = sem(var_resid_pct)) %>%
  ggplot(aes(factor(raw_fit, levels = c("raw", "EZ", "hddm"), labels=c("Raw", "EZ-diffusion", "Hierarchical diffusion")), mean_var_subs_pct, shape=factor(rt_acc, levels = c("rt","accuracy", "drift rate", "threshold", "non-decision"), labels=c("Response Time", "Accuracy","Drift Rate", "Threshold", "Non-decision"))))+
  geom_point(position=position_dodge(width=0.75), size = 15)+
  geom_errorbar(aes(ymin = mean_var_subs_pct - sem_var_subs_pct, ymax = mean_var_subs_pct + sem_var_subs_pct), position=position_dodge(width=0.75))+
facet_wrap(~factor(overall_difference, levels = c("non-contrast", "contrast", "condition"), labels = c("Non-contrast", "Contrast", "Condition")))+
  ylab("% of between subjects \n variance")+
  xlab("")+
  theme(legend.title = element_blank(),
        legend.position = 'bottom',
        axis.text = element_text(size=36),
        axis.title.y = element_text(size=36), 
        strip.text = element_text(size=36),
        legend.text = element_text(size=36),
        legend.spacing.x = unit(0.4, "cm"),
        legend.key.size = unit(4, "cm"))

ggsave('var_subs_ddm_plot.jpeg', device = "jpeg", plot=p2, path = "../output/figures/", width = 38, height = 8, units = "in", limitsize = FALSE, dpi = 300)
```